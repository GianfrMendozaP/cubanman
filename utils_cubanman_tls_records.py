#!/usr/bin/python3
def recordLen(headers:list) -> int:
    #returns total length of the record including the header length (5) 
    #takes the first 5 bytes of the record as argument in a LIST format

    return ((headers[3] * 256) + headers[4]) + 5

def x16Scan(data:bytes, dataLength:int=0, showRecords:bool=False) -> int:
    #returns bytes left to receive. 0 if NONE
    if not dataLength: dataLength = len(data)
    byteCount = 0

    while True:

        headers = [byte for byte in data[:5]]
        if showRecords: print(headers)
        length = recordLen(headers)
        if showRecords: print(length, data[:length])
        data = data[length:]
        byteCount += length

        if byteCount >= dataLength: break

    return byteCount - dataLength

def main():
    sample = b'\x16\x03\x03\n=\x0b\x00\n9\x00\n6\x00\x05&0\x82\x05"0\x82\x04\n\xa0\x03\x02\x01\x02\x02\x12\x05A\x08Q>D|b\xf3\x8bg\x8e1\xf3\xc9\xa2\x8eA0\r\x06\t*\x86H\x86\xf7\r\x01\x01\x0b\x05\x00031\x0b0\t\x06\x03U\x04\x06\x13\x02US1\x160\x14\x06\x03U\x04\n\x13\rLet\'s Encrypt1\x0c0\n\x06\x03U\x04\x03\x13\x03R120\x1e\x17\r251006151611Z\x17\r260104151610Z0.1,0*\x06\x03U\x04\x03\x13#content-signature-2.cdn.mozilla.net0\x82\x01"0\r\x06\t*\x86H\x86\xf7\r\x01\x01\x01\x05\x00\x03\x82\x01\x0f\x000\x82\x01\n\x02\x82\x01\x01\x00\x88\xce\xd4\xb77\x99\xfd\x8aj\x9bb\x06\\D\x8a1\xfb{\x93`\xfdH\xfb\xd8\xe5\x9c&pAq\xebE\xf9%AF[\xbb\xf0\xe0\xeeU.]v\x00\xfe\x04\xf8\xa3_\x91n:X\x9a\xa3%u\xefw\xa8\xc0\xd6(\xc0\xedqpp\xa1\x10\x82[\xd5,Y\xb0?\xd0\x9e\xf5D\x06x5\xca\x17\xd3\x11\xe7\xe7\t\xc9\xbf\xb9\x99+\x17\x82F\x86*\xf37\xa5\xb0j\x8fw#\x89\'H\xefs\xc3\x89\xdb\xc0^\x1a\x0b-`\xff!\xec/\xcd\xc5V\xe40(\xaf\xad\xce\xcd\x8b\x07\xd8\xe8\xb3-\x18\x04\ri\xf78\xf7\x90\x96\x10\xa6\x98\xae\x05\xda\xb6\xf1\x8f\xfd\x88\x94\xd3 ^\xc6A)\x88\xb8\xdc\xb37\xb9m\xbbR\xec\x83\xf4\xe4\xcb\x08\xc5L\xdfJ)\x80\x1bC\x17=\xf8P\x01]\xac\xe6\xe7K\xf8DH\xdb\xd0\x0bV\xffM\xa9\xed\xf5\xd46\xd8\x96\x1ex\x9a\xf0\xaa\xd4\xfbFq\xa7\xccc\xd3\xfcy\x90-\xd5lS\x0f\xed\xf1\xa3xde\xd6\xf6>/\xa6\xf6\x0b\xd5\x02\x03\x01\x00\x01\xa3\x82\x0230\x82\x02/0\x0e\x06\x03U\x1d\x0f\x01\x01\xff\x04\x04\x03\x02\x05\xa00\x1d\x06\x03U\x1d%\x04\x160\x14\x06\x08+\x06\x01\x05\x05\x07\x03\x01\x06\x08+\x06\x01\x05\x05\x07\x03\x020\x0c\x06\x03U\x1d\x13\x01\x01\xff\x04\x020\x000\x1d\x06\x03U\x1d\x0e\x04\x16\x04\x14\x03\xbf\x0e\x0f\xfd,:\x86 \x93\xbf\x0b\xd0\x0f\x83\x9e\xd3\xb4\x86\xe00\x1f\x06\x03U\x1d#\x04\x180\x16\x80\x14\x00\xb5)\xf2-\x8eo1\xe8\x9bL\xadx>\xfa\xdc\xe9\x0c\xd1\xd203\x06\x08+\x06\x01\x05\x05\x07\x01\x01\x04\'0%0#\x06\x08+\x06\x01\x05\x05\x070\x02\x86\x17http://r12.i.lencr.org/0.\x06\x03U\x1d\x11\x04\'0%\x82#content-signature-2.cdn.mozilla.net0\x13\x06\x03U\x1d \x04\x0c0\n0\x08\x06\x06g\x81\x0c\x01\x02\x010.\x06\x03U\x1d\x1f\x04\'0%0#\xa0!\xa0\x1f\x86\x1dhttp://r12.c.lencr.org/66.crl0\x82\x01\x04\x06\n+\x06\x01\x04\x01\xd6y\x02\x04\x02\x04\x81\xf5\x04\x81\xf2\x00\xf0\x00v\x00\xed<K\xd6\xe8\x06\xc2\xa4\xa2\x00W\xdb\xcb$\xe28\x01\xdfQ/\xed\xc4\x86\xc5p\x0f \xdd\xb7>?\xe0\x00\x00\x01\x99\xbaM\xbf&\x00\x00\x04\x03\x00G0E\x02!\x00\xef\xe3\xa7V\xc6\x85\xa8w.\xd2\x9e\\\xbd\x1dZ\xbf\x9b\xac5\x84v\xc4\xd8\xea\xbfF|\x88]c\xeaY\x02 }\xf4Q\xb1\x1f;J\xb6\xfdY\x80\x11\x03\xf1\xe5\xc1\x9c\xec\x83\x8c\xab?1\xb9\x02\x17\x8e\x06\xd6\xd4\x12\xa2\x00v\x00\x0eW\x94\xbc\xf3\xae\xa9>3\x1b,\x99\x07\xb3\xf7\x90\xdf\x9b\xc2=q2%\xdd!\xa9%\xaca\xc5N!\x00\x00\x01\x99\xbaM\xbf)\x00\x00\x04\x03\x00G0E\x02!\x00\xad\x92\x08\xc1B\xa9\xad\xb8\x94\x8c=\xfb\xabO\xf9ve\xa7\x93kf\xbd\xfc\x14hR/\xd1\x97U\x18[\x02 F\xcdg\xe7?%%\xbe\xe2vQ\xe5?s|\xe3\x91\xe48?`\xb2\xc1M3s\xc2\xc6\xde\xbf\x9370\r\x06\t*\x86H\x86\xf7\r\x01\x01\x0b\x05\x00\x03\x82\x01\x01\x00\r\xf8V\xd7\x86\xd2\xc1\xae\xb2\xe5!\x82\xc7\x85\x87>f\x11\x9d\x8d\x1fm\xb2\xad\x7f\xc5\x9c\x80~+\t\xc6\x9b\x84\xe6bj\x00\xfa\x02v\x8cM\xc7d\x04+{:\x06\x8f\xd0\xab\x1bX\x139\xa7\xf71t/\xfe\xad\xc8\xf6\xf2b\xe9\xccq\xfdp\xc4\xb4\xc2\xa5Z\x974\x15\xe7\x95\xbbZ\x0f\x0f\x01v\xb6\xb8\x04\xc6\xd9\xa3\x1c\x12\x02K\x85\x84\xb4\xbd\x95I\xebN/\xa3\xf1B\xb5y3@\x107&=1?\xbdy\x9eY\x96\x11\xf7\x07\x83\xd9E\xe0\xb7\x88\xeb\x0b[iz\xc9\x9c%XT\xfc<r\xd2\xaf\x12Bm\x9dEz\xebQM\x14Da\xac\xefG\xdb\x86\xdd~\ns\xbf\xbb\x08\xe7\xf7\x99\x0c\x17\xd2T\x9e\xac\xff\xff\x1b\xd9\xeb\x90\xd4D\xf4\x0em\x9cu\t\xce[\xf6\xd81\xc1\x042\x03\x82\xe0\x11\xe5W\x06n9\xf6\xd8\xec\xba\xde\xe5\xcc32\x99Dw\x81@\xd3a\x8b\xfe\x1b\xcc\xc0h\xf3\xffK\xb6\xf60'


    print(x16Scan(sample,0,True))

if __name__ == '__main__':
    main()
